### 分页插件的使用

> 正常来说，我们构建分页功能时，需要通过`当前显示的页面值`以及`每页显示的信息条数`来计算指定页数中应该显示的内容

当我们一共有50条数据的时候，设定每页显示7条数据，那么一共会有8页数据。我们点击1～8页之中其中一页时，需要检索出当前页应该显示的内容。例如点击第7页应该显示第43～49条数据。

-----

### 传统分页

传统分页功能的实现依赖于数据库指令的Limit关键字，通过设置显示的起始条数以及显示条数来获取到指定范围的数据，然后进行显示。

这样实现的分页功能的局限在于：

1. 手动在数据全部获取SQL的基础上新增Limit关键字

2. 手动判断当前页面上下文情况(上一页/下一页是多少，是否存在等情况)

3. 手动设置展示页面的范围

&nbsp;

----

### 分页插件pagehelper

分页插件即是通过插件的形式，简化实现分页功能的过程，让开发者使用简单的方式即可实现分页。<mark>可以解决传统分页的局限问题。</mark>

关于pagehelper插件使用的关键就在于理解其两个关键的实体类，分别是`Page`以及`PageInfo`对象。

##### Page对象解析

```java
public class Page<E> extends ArrayList<E> implements Closeable {
    //字段解析
    private static final long serialVersionUID = 1L;
    private int pageNum;
    private int pageSize;
    private long startRow;
    private long endRow;
    private long total;
    private int pages;
    private boolean count;
}
```

1) ***count字段***：当前Page对象中是否存在数据

2) ***pageNum字段***：当前页码

3) ***startRow字段***：即当前页码的起始数据索引

4) ***endRow字段***：即当前页码的结尾数据索引

5) ***total字段***：即当前分页的总数据条数

6) ***pages字段***：即当前分页的总页数

7) ***数据存储字段***：即继承ArrayList集合中的集合实例(操作方式和List一致)

&nbsp;

##### PageInfo对象解析

当Page对象中字段无法满足分页的需求，那么就`搭配`使用PageInfo对象。

```java
public class PageInfo<T> extends PageSerializable<T> {
    public static final int DEFAULT_NAVIGATE_PAGES = 8;
    private int pageNum;
    private int pageSize;
    private int size;
    private long startRow;
    private long endRow;
    private int pages;
    private int prePage;
    private int nextPage;
    private boolean isFirstPage;
    private boolean isLastPage;
    private boolean hasPreviousPage;
    private boolean hasNextPage;
    private int navigatePages;
    private int[] navigatepageNums;
    private int navigateFirstPage;
    private int navigateLastPage;
}
```

可以发现除了Page的基础属性之后，还有拥有着很多新字段。

1. ***pageSize字段***：即页码应当存在多少条数据

2. ***size字段***：当前页码实际存在多少条数据(比如最后一页有可能满足不到应当条数)

3. ***prePage字段***：即当前页码的上一页页码

4. ***nexrtPage字段***：即当前页码的下一页页码

5. ***isFirstPage字段***：当前页是否是首页

6. ***isLastPage字段***：当前页是否是最后一页

7. ***hasPreviousPage字段***：上一页是否存在

8. ***hasNextPage字段***：下一页是否存在

9. ***navigatePages字段***：即展示页码列表范围大小，比如为5时，<mark>展示三种情况下</mark>，范围5的页码列表。

10. ***navigateFirstPage字段***：即展示页码列表的头页码值

11. ***navigateLastPage字段***：即展示页码列表的尾页码值

12. ***navigatepageNums字段***：数组类型，即展示页码列表

-----

### 分页插件pagehelper的使用

##### 前置条件

**第一步：导入坐标**

```xml
        <dependency>
            <groupId>com.github.pagehelper</groupId>
            <artifactId>pagehelper</artifactId>
            <version>5.2.0</version>
        </dependency>
```

**第二步：在Mybatis核心配置中进行全局配置**

```xml
    <plugins>
        <plugin interceptor="com.github.pagehelper.PageInterceptor"></plugin>
    </plugins>
```

&nbsp;

##### 单纯使用Page对象

```java
    public static void main(String[] args) {
        SqlSession sqlSession = sqlSessionFactory.openSession();
        ChatRecordManageMapper mapper = sqlSession.getMapper(ChatRecordManageMapper.class);
        PageHelper.startPage(1,5); //( pageNum , pageSize )
        List<ChatRecord> chatRecordByDataBase = mapper.getChatRecordByDataBase("1804230910");
        System.out.println(chatRecordByDataBase);
        sqlSession.close();
    }
```

```java
Page{
    count=true, 
    pageNum=1, 
    pageSize=5, 
    startRow=0, 
    endRow=5, 
    total=17, 
    pages=4, 
    reasonable=false, 
    pageSizeZero=false
}
[ChatRecord(crId=224, toName=1804230901, record=nihao), 
ChatRecord(crId=229, toName=1804230901, record=123),
ChatRecord(crId=230, toName=1804230901, record=456), 
ChatRecord(crId=231, toName=1804230901, record=789), 
ChatRecord(crId=232, toName=1804230901, record=abc)]

```

&nbsp;

##### Page对象搭配PageInfo对象使用

```java
    public static void main(String[] args) {
        SqlSession sqlSession = sqlSessionFactory.openSession();
        ChatRecordManageMapper mapper = sqlSession.getMapper(ChatRecordManageMapper.class);
        PageHelper.startPage(1,5);
        List<ChatRecord> chatRecords = mapper.getChatRecordByDataBase("1804230910");
        PageInfo<ChatRecord> chatRecordPageInfo = new PageInfo<>(chatRecords,5);
        System.out.println(chatRecordPageInfo);
        sqlSession.close();
    }
```

```java
PageInfo{
    pageNum=1, 
    pageSize=5, 
    size=5, 
    startRow=1, 
    endRow=5, 
    total=17, 
    pages=4, 
    list=Page{
        count=true, 
        pageNum=1, 
        pageSize=5, 
        startRow=0, 
        endRow=5, 
        total=17, 
        pages=4, 
        reasonable=false, 
        pageSizeZero=false
}
[ChatRecord(crId=224, toName=1804230901, record=nihao), 
ChatRecord(crId=229, toName=1804230901, record=123), 
ChatRecord(crId=230, toName=1804230901, record=456), 
ChatRecord(crId=231, toName=1804230901, record=789), 
ChatRecord(crId=232, toName=1804230901, record=abc)],
prePage=0, 
nextPage=2, 
isFirstPage=true, 
isLastPage=false,
hasPreviousPage=false, 
hasNextPage=true,
navigatePages=5,
navigateFirstPage=1, 
navigateLastPage=4, 
navigatepageNums=[1, 2, 3, 4]
}
```


